@import "colorScheme";

$output-layer-group-line: 1px solid #000;
$output-layer-group-collapse-animation-duration: 0.5s;

.segment-timeline {
	display: grid;
	grid-column-gap: 0;
	grid-row-gap: 0;
	grid-template-columns: [segment-name] 200px [segment-group-controls] 120px [timeline] auto [end];
	grid-template-rows: [header] 3em [main-view] auto [zoom-area] 3em [end];
	overflow: hidden;

	.segment-timeline__title {
		display: block;
		margin: 0;
		padding: 0;

		grid-column: segment-name / segment-group-controls;
		grid-row: main-view / zoom-area;
	}

	.segment-timeline__mos-id {
		display: none;
	}

	.segment-timeline__timeline-grid {
		grid-column: timeline / end;
		grid-row: main-view / zoom-area;
	}

	.segment-timeline__timeline {
		grid-column: timeline / end;
		grid-row: main-view / zoom-area;

		.segment-timeline__segment-line {
			.segment-timeline__output-group {
				.segment-timeline__layer {
					transition: $output-layer-group-collapse-animation-duration min-height ease-in-out;

					.segment-timeline__layer-item {
						.segment-timeline__layer-item__label {
							transition: ($output-layer-group-collapse-animation-duration * 1/3) opacity ($output-layer-group-collapse-animation-duration * 2/3)
						}
					}
				}

				&.collapsable {
					&.collapsed {
						.segment-timeline__layer {
							min-height: 0;
	
							.segment-timeline__layer-item {
								.segment-timeline__layer-item__label {
									opacity: 0;
									visibility: hidden;
									transition: ($output-layer-group-collapse-animation-duration * 1/3) opacity,
												0s visibility ($output-layer-group-collapse-animation-duration * 1/3);
								}
							}
						}
					}
				}
			}
		}
	}

	.segment-timeline__output-layers {
		grid-column: segment-group-controls / timeline;
		grid-row: main-view / zoom-area;

		.segment-timeline__output-layer-control {
			.segment-timeline__output-layer-control__layer {
				transition: $output-layer-group-collapse-animation-duration min-height ease-in-out,
							$output-layer-group-collapse-animation-duration height ease-in-out,
							$output-layer-group-collapse-animation-duration opacity,
							0s visibility 0s;
			}

			&.collapsable {
				&::after {
					content: ' ';
					display: block;
					position: absolute;
					border-left: $output-layer-group-line;
					border-bottom: $output-layer-group-line;
					top: 1em;
					left: 1em;
					bottom: 0.4em;
					width: 50px;
					box-sizing: border-box;
					opacity: 1;
					transition: ($output-layer-group-collapse-animation-duration * 1/3) opacity ($output-layer-group-collapse-animation-duration * 2/3);
				}

				&.collapsed {
					.segment-timeline__output-layer-control__layer {
						transition: $output-layer-group-collapse-animation-duration min-height ease-in-out,
									$output-layer-group-collapse-animation-duration height ease-in-out,
									$output-layer-group-collapse-animation-duration opacity,
									0s visibility $output-layer-group-collapse-animation-duration;
						height: 0;
						min-height: 0;
						opacity: 0;
						visibility: hidden;
					}

					&::after {
						transition: ($output-layer-group-collapse-animation-duration * 1/3) opacity;
						opacity: 0;
					}
				}
			}
		}
	}
}